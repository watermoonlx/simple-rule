## 并行验证

`ParallelRuleSet<T>`类用于支持并行验证，该规则集中包含的规则将并行地开启验证。

有三种方法可以创建一个`ParallelRuleSet<T>`实例：
1. 通过`ParallelRuleSet<T>`构造函数。
2. 通过`Rule.parallel()`静态方法。
3. 继承`ParallelRuleSet<T>`，创建一个单独的RuleSet类。

以第1种方法为例：

```java
    @Test
    public void testParallel() {
        // 定义一个规则，该规则检查将耗时约2秒。
        class DelayRule extends Rule<String> {
            @Override
            public RuleCheckResult check(@NonNull String target) {
                try {
                    Thread.sleep(2000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }

                return this.pass();
            }
        }

        // 创建一个并行规则集
        ParallelRuleSet<String> ruleSet = new ParallelRuleSet<>(
                new DelayRule(),
                new DelayRule(),
                new DelayRule(),
                new DelayRule(),
                new DelayRule(),
                new DelayRule(),
                new DelayRule(),
                new DelayRule(),
                new DelayRule(),
                new DelayRule()
        );

        // 测量规则集执行时间
        LocalDateTime start = LocalDateTime.now();
        RuleCheckResult result = ruleSet.checkAsync("Any").join();
        LocalDateTime end = LocalDateTime.now();
        long elapsed = Duration.between(start, end).toMillis();
        // 执行时间应低于3秒
        Assertions.assertTrue(elapsed < 3000);
    }
```

默认情况下，并发规则集使用`ForkJoinPool.commonPool()`线程池。也可以自定义线程池。不过需要显式地创建`RuleEngine`。